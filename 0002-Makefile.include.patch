From 1682a8cc2a8a171f3b220709da7f5cf6b2f6e835 Mon Sep 17 00:00:00 2001
Message-Id: <1682a8cc2a8a171f3b220709da7f5cf6b2f6e835.1492608138.git.devel@agrez.net>
From: Vaughan Agrez <devel@agrez.net>
Date: Wed, 19 Apr 2017 21:21:37 +0800
Subject: [PATCH] Modify Makefile.include

---
 Makefile.include | 62 ++++++++++++++++++++------------------------------------
 1 file changed, 22 insertions(+), 40 deletions(-)

diff --git a/Makefile.include b/Makefile.include
index 58e9560..a1e4d37 100644
--- a/Makefile.include
+++ b/Makefile.include
@@ -1,40 +1,22 @@
-USE_BUILDROOT=0
-FLOAT=hard
-
-ifeq ($(USE_BUILDROOT), 1)
-BUILDROOT	:=/opt/xbmc-bcm/buildroot
-SDKSTAGE	:=$(BUILDROOT)/output/staging
-TARGETFS	:=$(BUILDROOT)/output/target
-TOOLCHAIN	:=$(BUILDROOT)/output/host/usr/
-HOST			:=arm-unknown-linux-gnueabi
-SYSROOT		:=$(BUILDROOT)/output/host/usr/arm-unknown-linux-gnueabi/sysroot
-else
-BUILDROOT	:=/opt/bcm-rootfs
-SDKSTAGE	:=/opt/bcm-rootfs
-TARGETFS	:=/opt/bcm-rootfs
-TOOLCHAIN	:=/home/dc4/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian/
-HOST		:=arm-linux-gnueabihf
-#SYSROOT		:=$(TOOLCHAIN)/arm-bcm2708hardfp-linux-gnueabi/sysroot
-SYSROOT		:=/opt/bcm-rootfs
-endif
-
-JOBS=7
-
-CFLAGS			:= -isystem$(PREFIX)/include
-CXXFLAGS		:= $(CFLAGS)
-CPPFLAGS		:= $(CFLAGS)
-LDFLAGS			:= -L$(BUILDROOT)/lib
-LD					:= $(TOOLCHAIN)/bin/$(HOST)-ld --sysroot=$(SYSROOT)
-CC					:= $(TOOLCHAIN)/bin/$(HOST)-gcc --sysroot=$(SYSROOT)
-CXX         := $(TOOLCHAIN)/bin/$(HOST)-g++ --sysroot=$(SYSROOT)
-OBJDUMP			:= $(TOOLCHAIN)/bin/$(HOST)-objdump
-RANLIB			:= $(TOOLCHAIN)/bin/$(HOST)-ranlib
-STRIP				:= $(TOOLCHAIN)/bin/$(HOST)-strip
-AR 					:= $(TOOLCHAIN)/bin/$(HOST)-ar
-CXXCP 			:= $(CXX) -E
-PATH 				:= $(PREFIX)/bin:$(BUILDROOT)/output/host/usr/bin:$(PATH)
-
-CFLAGS			+= -pipe -mfloat-abi=$(FLOAT) -mcpu=arm1176jzf-s -fomit-frame-pointer -mabi=aapcs-linux -mtune=arm1176jzf-s -mfpu=vfp -Wno-psabi -mno-apcs-stack-check -g -mstructure-size-boundary=32 -mno-sched-prolog
-LDFLAGS			+= -L$(SDKSTAGE)/lib -L$(SDKSTAGE)/usr/lib -L$(SDKSTAGE)/opt/vc/lib/ -Lpcre/build
-#INCLUDES		+= -isystem$(SDKSTAGE)/usr/include -isystem$(SDKSTAGE)/opt/vc/include -isystem$(SYSROOT)/usr/include -isystem$(SDKSTAGE)/opt/vc/include/interface/vcos/pthreads -isystem$(SDKSTAGE)/usr/include/freetype2
-INCLUDES		+= -isystem$(SDKSTAGE)/opt/vc/include -isystem$(SYSROOT)/usr/include -isystem$(SDKSTAGE)/opt/vc/include/interface/vcos/pthreads -Ipcre/build -Iboost-trunk -Ifreetype2/include
+BUILDROOT	:=
+SDKSTAGE	:=
+TARGETFS	:=
+TOOLCHAIN	:=
+HOST		:=
+SYSROOT		:=
+JOBS=4
+CFLAGS		:= -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -march=armv7-a -mfpu=vfpv3-d16  -mfloat-abi=hard
+CXXFLAGS	:= $(CFLAGS)
+CPPFLAGS	:= $(CFLAGS)
+LDFLAGS		:= -L$(BUILDROOT)/lib
+LD		:= ld
+CC		:= gcc
+CXX         	:= g++
+OBJDUMP		:= objdump
+RANLIB		:= ranlib
+STRIP		:= strip
+AR 		:= ar
+CXXCP 		:= $(CXX) -E
+PATH 		:= $(PREFIX)/bin:$(PATH)
+LDFLAGS		+= -L/lib -L/usr/lib -L/usr/lib/vc/ -Lpcre/build
+INCLUDES	+= -I/usr/include/vc -I/usr/include/vc/interface/vmcs_host -I/usr/include/vc/interface/vmcs_host/linux -I/usr/include/vc/interface/vcos/pthreads -I/usr/include/freetype2 -I/usr/include/dbus-1.0 -I/usr/lib/dbus-1.0/include
-- 
2.9.3

